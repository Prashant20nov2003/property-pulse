(()=>{var e={};e.id=750,e.ids=[750],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},55315:e=>{"use strict";e.exports=require("path")},86624:e=>{"use strict";e.exports=require("querystring")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},40655:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>p,pages:()=>c,routeModule:()=>m,tree:()=>l}),t(14729),t(49338),t(22810),t(78107),t(57522);var s=t(30170),a=t(45002),i=t(83876),n=t.n(i),o=t(66299),d={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>o[e]);t.d(r,d);let l=["",{children:["messages",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,14729)),"D:\\binary\\property-pulse\\app\\messages\\page.jsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,49338)),"D:\\binary\\property-pulse\\app\\layout.jsx"],error:[()=>Promise.resolve().then(t.bind(t,22810)),"D:\\binary\\property-pulse\\app\\error.jsx"],loading:[()=>Promise.resolve().then(t.bind(t,78107)),"D:\\binary\\property-pulse\\app\\loading.jsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,57522)),"D:\\binary\\property-pulse\\app\\not-found.jsx"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,57481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["D:\\binary\\property-pulse\\app\\messages\\page.jsx"],p="/messages/page",u={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/messages/page",pathname:"/messages",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},47304:(e,r,t)=>{let s={"1ef81fcc34f610f969097770a48d804124c5f7ca":()=>Promise.resolve().then(t.bind(t,30638)).then(e=>e.default),"4735d14899686559796dc92456fafcb2506e4cfc":()=>Promise.resolve().then(t.bind(t,12513)).then(e=>e.default),"7d656f77a71f85c3755865bfd21dd6c0f5727553":()=>Promise.resolve().then(t.bind(t,85670)).then(e=>e.default)};async function a(e,...r){return(await s[e]()).apply(null,r)}e.exports={"1ef81fcc34f610f969097770a48d804124c5f7ca":a.bind(null,"1ef81fcc34f610f969097770a48d804124c5f7ca"),"4735d14899686559796dc92456fafcb2506e4cfc":a.bind(null,"4735d14899686559796dc92456fafcb2506e4cfc"),"7d656f77a71f85c3755865bfd21dd6c0f5727553":a.bind(null,"7d656f77a71f85c3755865bfd21dd6c0f5727553")}},87493:(e,r,t)=>{Promise.resolve().then(t.bind(t,5859))},5859:(e,r,t)=>{"use strict";t.d(r,{default:()=>c});var s=t(97247),a=t(28964),i=t(50571);t(70689);var n=t(11294);let o=(0,n.$)("1ef81fcc34f610f969097770a48d804124c5f7ca"),d=(0,n.$)("4735d14899686559796dc92456fafcb2506e4cfc");var l=t(6809);let c=({message:e})=>{let[r,t]=(0,a.useState)(e.read),[n,c]=(0,a.useState)(!1),{setUnreadCount:p}=(0,l.b)(),u=async()=>{let r=await o(e._id);t(r),p(e=>r?e-1:e+1),i.Am.success(`Marked as ${r?"read":"new"}`)},m=async()=>{await d(e._id),c(!0),p(e=>r?e:e-1),i.Am.success("Message Deleted")};return n?s.jsx("p",{children:"Deleted message"}):(0,s.jsxs)("div",{className:"relative bg-white p-4 rounded-md shadow-md border border-gray-200",children:[!r&&s.jsx("div",{className:"absolute top-2 right-2 bg-yellow-500 text-white px-2 py-1 rounded-md",children:"New"}),(0,s.jsxs)("h2",{className:"text-xl mb-4",children:[s.jsx("span",{className:"font-bold",children:"Property Inquiry:"})," ",e.property.name]}),s.jsx("p",{className:"text-gray-700",children:e.body}),(0,s.jsxs)("ul",{className:"mt-4",children:[(0,s.jsxs)("li",{children:[s.jsx("strong",{children:"Reply Email:"})," ",s.jsx("a",{href:`mailto:${e.email}`,className:"text-blue-500",children:e.email})]}),(0,s.jsxs)("li",{children:[s.jsx("strong",{children:"Reply Phone:"})," ",s.jsx("a",{href:`tel:${e.phone}`,className:"text-blue-500",children:e.phone})]}),(0,s.jsxs)("li",{children:[s.jsx("strong",{children:"Received:"})," ",new Date(e.createdAt).toLocaleString()]})]}),s.jsx("button",{onClick:u,className:`mt-4 mr-3 ${r?"bg-gray-300":"bg-blue-500 text-white"} py-1 px-3 rounded-md`,children:r?"Mark As New":"Mark As Read"}),s.jsx("button",{onClick:m,className:"mt-4 bg-red-500 text-white py-1 px-3 rounded-md",children:"Delete"})]})}},12513:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var s=t(28713);t(9640);var a=t(70570),i=t(50490),n=t(67619),o=t(80166),d=t(83557);async function l(e){await (0,a.default)();let r=await (0,n.getSessionUser)();if(!r||!r.user)throw Error("User ID is required");let{userId:t}=r,s=await i.Z.findById(e);if(!s)throw Error("Message Not Found");if(s.recipient.toString()!==t)throw Error("Unauthorized");(0,o.revalidatePath)("/messages","page"),await s.deleteOne()}let c=l;(0,d.h)([l]),(0,s.j)("4735d14899686559796dc92456fafcb2506e4cfc",l)},30638:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>c});var s=t(28713);t(9640);var a=t(70570),i=t(50490),n=t(67619),o=t(80166),d=t(83557);async function l(e){await (0,a.default)();let r=await (0,n.getSessionUser)();if(!r||!r.user)throw Error("User ID is required");let{userId:t}=r,s=await i.Z.findById(e);if(!s)throw Error("Message not found");return s.recipient.toString()!==t?new Response("Unauthorized",{status:401}):(s.read=!s.read,(0,o.revalidatePath)("/messages","page"),await s.save(),s.read)}let c=l;(0,d.h)([l]),(0,s.j)("1ef81fcc34f610f969097770a48d804124c5f7ca",l)},14729:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>p});var s=t(72051),a=t(61299),i=t(11185);let n=new i.Schema({sender:{type:i.Schema.Types.ObjectId,ref:"User",required:!0},recipient:{type:i.Schema.Types.ObjectId,ref:"User",required:!0},property:{type:i.Schema.Types.ObjectId,ref:"Property",required:!0},name:{type:String,required:[!0,"Name is required"]},email:{type:String,required:[!0,"Email is required"]},phone:{type:String},body:{type:String},read:{type:Boolean,default:!1}},{timestamps:!0}),o=i.models.Message||(0,i.model)("Message",n),d=(0,t(45347).createProxy)(String.raw`D:\binary\property-pulse\components\MessageCard.jsx#default`);t(33065);var l=t(11819),c=t(6454);let p=async()=>{await (0,a.Z)();let{userId:e}=await (0,c.x)();console.log(e);let r=await o.find({recipient:e,read:!0}).sort({createdAt:-1}).populate("sender","username").populate("property","name").lean(),t=[...await o.find({recipient:e,read:!1}).sort({createdAt:-1}).populate("sender","username").populate("property","name").lean(),...r].map(e=>{let r=(0,l.R)(e);return r.sender=(0,l.R)(e.sender),r.property=(0,l.R)(e.property),r});return s.jsx("section",{className:"bg-blue-50",children:s.jsx("div",{className:"container m-auto py-24 max-w-6xl",children:(0,s.jsxs)("div",{className:"bg-white px-6 py-8 mb-4 shadow-md rounded-md border m-4 md:m-0",children:[s.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Your Messages"}),s.jsx("div",{className:"space-y-4",children:0===t.length?s.jsx("p",{children:"You have no messages"}):t.map(e=>s.jsx(d,{message:e},e._id))})]})})})}},61299:(e,r,t)=>{"use strict";t.d(r,{Z:()=>n});var s=t(11185),a=t.n(s);let i=!1,n=async()=>{if(a().set("strictQuery",!0),i){console.log("MongoDB is already connected...");return}try{await a().connect(process.env.MONGODB_URI),i=!0,console.log("MongoDB connected...")}catch(e){console.log(e)}}},33065:(e,r,t)=>{"use strict";t.d(r,{Z:()=>i});var s=t(11185);let a=new s.Schema({owner:{type:s.Schema.Types.ObjectId,ref:"User",required:!0},name:{type:String,required:!0},type:{type:String,required:!0},description:{type:String},location:{street:{type:String},city:{type:String},state:{type:String},zipcode:{type:String}},beds:{type:Number,required:!0},baths:{type:Number,required:!0},square_feet:{type:Number,required:!0},amenities:[{type:String}],rates:{nightly:{type:Number},weekly:{type:Number},monthly:{type:Number}},seller_info:{name:{type:String},email:{type:String},phone:{type:String}},images:[{type:String}],is_featured:{type:Boolean,default:!1}},{timestamps:!0}),i=s.models.Property||(0,s.model)("Property",a)},80851:(e,r,t)=>{"use strict";t.d(r,{Z:()=>i});var s=t(11185);let a=new s.Schema({email:{type:String,unique:[!0,"Email already exists"],required:[!0,"Email is required"]},username:{type:String,required:[!0,"Username is required"]},image:{type:String},bookmarks:[{type:s.Schema.Types.ObjectId,ref:"Property"}]},{timestamps:!0}),i=s.models.User||(0,s.model)("User",a)},5412:(e,r,t)=>{"use strict";t.d(r,{L:()=>i});var s=t(61299),a=t(80851);let i={providers:[(0,t(22571).Z)({clientId:process.env.GOOGLE_CLIENT_ID,clientSecret:process.env.GOOGLE_CLIENT_SECRET,authorization:{params:{prompt:"consent",access_type:"offline",response_type:"code"}}})],callbacks:{async signIn({profile:e}){if(await (0,s.Z)(),!await a.Z.findOne({email:e.email})){let r=e.name.slice(0,20);await a.Z.create({email:e.email,username:r,image:e.picture})}return!0},async session({session:e}){let r=await a.Z.findOne({email:e.user.email});return e.user.id=r._id.toString(),e}}}},11819:(e,r,t)=>{"use strict";function s(e){for(let r of Object.keys(e))e[r].toJSON&&e[r].toString&&(e[r]=e[r].toString());return e}t.d(r,{R:()=>s})},6454:(e,r,t)=>{"use strict";t.d(r,{x:()=>i});var s=t(4128),a=t(5412);let i=async()=>{let e=await (0,s.Z1)(a.L);return e&&e.user?{user:e.user,userId:e.user.id}:null}}};var r=require("../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[379,361,781,166,882],()=>t(40655));module.exports=s})();